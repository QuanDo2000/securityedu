### 1. LLMNR and Netbios concepts

Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS) are Microsoft Windows components that serve as alternate methods of host identification. LLMNR is based upon the Domain Name System (DNS) format and allows hosts on the same local link to perform name resolution for other hosts. NBT-NS identifies systems on a local network by their NetBIOS name.

### 2. What is LLMNR poisoning 
-	Link-Local Multicast Name Resolution (LLMNR) and Netbios Name Service (NBT-NS) are two components of Microsoft Windows machines.
-	They are both seemingly innocuous components which allow machines on the same subnet help each other identify hosts when DNS fails.  
-	If one machine tries to resolve a particular host, but DNS resolution fails, the machine will then attempt to ask all other machines on the local network for the correct address via LLMNR or NBT-NS.

### 3. How hacker can exploit 
An attacker can listen on a network for these LLMNR (UDP/5355) or NBT-NS (UDP/137) broadcasts and respond to them, thus pretending that the attacker knows the location of the requested host. 
![image](https://user-images.githubusercontent.com/112114250/202667392-a03ced23-6c1b-445a-bb9a-d61ae2a77bfd.png)

### 4. NTLM relay
#### What is NTLM?
-	Net-NTLM (NTLMv1 or NTLMv2) hashes are used for network authentication (they are derived from a challenge/response algorithm and are based on the user's NT hash), and we can use this hash to relay to other machines and try to authenticate.

#### NTLM relay mitigation
- Microsoft has a good [post](https://support.microsoft.com/en-gb/topic/kb5005413-mitigating-ntlm-relay-attacks-on-active-directory-certificate-services-ad-cs-3612b773-4043-4aa9-b23d-b87910cd3429) in mitigating NTLM relay

### 5. SMB relay
#### What is SMB?
The SMB protocol allows a client (i.e. your machine) to communicate with a server and, by extension, with the other network-based resources. Itâ€™s also called a server\client protocol. SMB governs everything from internetwork file-sharing to doc-editing on a remote machine.

#### How SMB relay works
The SMB Relay attack abuses the NTLM challenge-response protocol. Commonly, all SMB sessions used the NTML protocol for encryption and authentication purposes (i.e. NTLM over SMB). However, most sysadmins switched to KILE over SMB after research proved that the first version of NTLM is susceptible to Man-in-the-Middle attacks, the SMB Relay attack counting among them.

#### SMB relay mitigation
Good [post](https://www.blueorangecompliance.com/mitigating-the-risks-of-relay-authentication-attacks/) in protecting against SMB relay.

### References
LLMNR and Netbios theory: https://attack.mitre.org/techniques/T1557/001/#:~:text=Adversaries%20can%20spoof%20an%20authoritative,with%20the%20adversary%20controlled%20system.
SMB and SMB relay concepts: https://heimdalsecurity.com/blog/what-is-an-smb-relay-attack/
SMB relay mitigation: https://www.blueorangecompliance.com/mitigating-the-risks-of-relay-authentication-attacks/
NTLM relay mitigation: https://support.microsoft.com/en-gb/topic/kb5005413-mitigating-ntlm-relay-attacks-on-active-directory-certificate-services-ad-cs-3612b773-4043-4aa9-b23d-b87910cd3429
